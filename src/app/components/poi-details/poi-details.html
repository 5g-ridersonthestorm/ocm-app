<div *ngIf="poi!=null && poi.AddressInfo!=null">
  <div class="banner">

   <div padding>
    <ion-segment [(ngModel)]="selectedTab">
      <ion-segment-button value="location" selected>
        <ion-label>
         Details
      </ion-label>
      </ion-segment-button>

      <ion-segment-button value="comments">
        <ion-label>Comments ({{poi.UserComments?poi.UserComments.length:0}})</ion-label>

      </ion-segment-button>
      <ion-segment-button value="media">
        <ion-label> Photos ({{poi.MediaItems?poi.MediaItems.length:0}})</ion-label>
      </ion-segment-button>
    </ion-segment>
  </div>

    <div *ngIf="selectedTab=='location'" class="address-details">

      <ion-toolbar>
        <ion-buttons slot="start">

          <ion-button size="small" (click)="addFavourite()" title="Add to Favourites">
            <ion-icon name="star" slot="start"></ion-icon>
            <ion-label>Save</ion-label>
          </ion-button>
          <ion-button (click)="edit()" title="Submit an Edit">
            <ion-icon name="create" slot="start"></ion-icon>
            <ion-label>Edit</ion-label>
          </ion-button>
        </ion-buttons>

        <ion-buttons slot="end">
          <ion-button (click)="launchNavigation()">
            <ion-icon name="navigate" slot="start"></ion-icon>
            <ion-label>Navigate</ion-label>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
      <ion-card *ngIf="poi.AddressInfo">

        <ion-card-header>
          <ion-card-subtitle>
            <ion-icon name="map"></ion-icon> {{ 'ocm.details.location.address' | translate }}
          </ion-card-subtitle>
        </ion-card-header>

        <ion-card-content>

          <div>
            <div *ngIf="poi.AddressInfo.AddressLine1"> {{poi.AddressInfo.AddressLine1}}</div>
            <div *ngIf="poi.AddressInfo.AddressLine2"> {{poi.AddressInfo.AddressLine2}}</div>
            <div *ngIf="poi.AddressInfo.Town"> {{poi.AddressInfo.Town}}</div>
            <div *ngIf="poi.AddressInfo.StateOrProvince"> {{poi.AddressInfo.StateOrProvince}}</div>
            <div *ngIf="poi.AddressInfo.Postcode"> {{poi.AddressInfo.Postcode}}</div>
            <div *ngIf="poi.AddressInfo.Country"> {{poi.AddressInfo.Country.Title}}</div>
          </div>
          <p *ngIf="poi.AddressInfo.AccessComments">
            {{poi.AddressInfo.AccessComments}}
          </p>

          <p *ngIf="poi.AddressInfo.ContactTelephone1">
            <ion-icon name="call"></ion-icon> {{poi.AddressInfo.ContactTelephone1}}
          </p>
          <p *ngIf="poi.AddressInfo.ContactTelephone2">
            <ion-icon name="call"></ion-icon> {{poi.AddressInfo.ContactTelephone2}}
          </p>

          <p *ngIf="poi.AddressInfo.ContactEmail">
            <ion-icon name="mail"></ion-icon> {{poi.AddressInfo.ContactEmail}}
          </p>

          <p *ngIf="poi.AddressInfo.RelatedURL">
            <ion-icon name="globe"></ion-icon> <a target="_system" href="{{poi.AddressInfo.RelatedURL}}">{{poi.AddressInfo.RelatedURL}}</a>
          </p>

          <p>
            <ion-icon name="map"></ion-icon>
            <ion-label>
              {{ 'ocm.details.location.latitude' | translate }}: {{poi.AddressInfo.Latitude | number:'1.1-8'}} , {{
              'ocm.details.location.longitude'
              | translate }}: {{poi.AddressInfo.Longitude | number:'1.1-8'}}
            </ion-label>
          </p>


        </ion-card-content>

      </ion-card>

      <ion-card>
        <ion-card-header>
          <ion-icon name="battery-charging"></ion-icon> {{ 'ocm.details.equipment.sectionTitle' | translate }}
        </ion-card-header>
        <ion-card-content>

          <p *ngIf="poi.NumberOfPoints!=null">{{ 'ocm.details.numberOfPoints' | translate }}: {{poi.NumberOfPoints}}</p>
          <ion-list>
            <ion-item *ngFor="let item of poi.Connections">
              <ion-avatar slot="start">
                <ion-icon name="flash"></ion-icon>
              </ion-avatar>
              <h3>{{item.ConnectionType?.Title}} <span class="details-minor" *ngIf="item.Quantity">x{{item.Quantity}}</span></h3>
              <p *ngIf="item.PowerKW">{{item.PowerKW}} kW</p>

              <p>
                <span *ngIf="item.Amps" class="details-minor">{{item.Amps}}A</span>
                <span *ngIf="item.Voltage" class="details-minor">{{item.Voltage}}V</span>
                <span *ngIf="item.CurrentType" class="details-minor">{{item.CurrentType?.Title}}</span>

              </p>

            </ion-item>

          </ion-list>
        </ion-card-content>
      </ion-card>

      <ion-card>
        <ion-card-header>
          <ion-icon name="book"></ion-icon> Usage Restrictions
        </ion-card-header>
        <ion-card-content>
          <p *ngIf="poi.StatusType!=null"><span class="label">{{ 'ocm.details.operationalStatus' | translate }}:</span>
            {{poi.StatusType.Title}}</p>
          <p *ngIf="poi.UsageType!=null"><span class="label">{{ 'ocm.details.usageType' | translate }}:</span>
            {{poi.UsageType.Title}}</p>
          <p *ngIf="poi.UsageCost!=null"><span class="label">{{ 'ocm.details.usageCost' | translate }}:</span>
            {{poi.UsageCost}}</p>
          <p *ngIf="poi.GeneralComments!=null"><br>{{ 'ocm.details.generalComments' | translate }}: <br>{{poi.GeneralComments}}</p>

        </ion-card-content>
      </ion-card>

      <ion-card *ngIf="poi.OperatorInfo">
        <ion-card-header>
          <ion-icon name="help-circle"></ion-icon> {{ 'ocm.details.operator.sectionTitle' | translate }}
          <ion-card-title>

          </ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <p padding-left>
            {{poi.OperatorInfo.Title}}
          </p>
          <p *ngIf="poi.OperatorInfo.WebsiteURL">
            <ion-icon name="link"></ion-icon> {{poi.OperatorInfo.WebsiteURL}}
          </p>
          <p *ngIf="poi.OperatorInfo.ContactEmail!=null">
            <ion-icon name="mail"></ion-icon> {{poi.OperatorInfo.ContactEmail}}
          </p>
          <p *ngIf="poi.OperatorInfo.FaultReportEmail!=null && poi.OperatorInfo.FaultReportEmail!=poi.OperatorInfo.ContactEmail">
            <ion-icon name="mail"></ion-icon> {{poi.OperatorInfo.FaultReportEmail}}
          </p>
        </ion-card-content>
      </ion-card>



      <ion-card>
        <ion-card-header>
          <ion-icon name="information-circle"></ion-icon> {{ 'ocm.details.advancedDetails' | translate }}
        </ion-card-header>
        <ion-card-content>

          <div *ngIf="poi.DataProvider">
            <h3>
              {{ 'ocm.details.dataProvider.sectionTitle' | translate }}
            </h3>

            <p>{{poi.DataProvider?.Title}}</p>
            <a *ngIf="poi.DataProvider.WebsiteURL" (click)="launchURL(poi.DataProvider.WebsiteURL)" href="javascript:void(0)">{{poi.DataProvider.WebsiteURL}}</a>

            <p>{{poi.DataProvider?.License}}</p>
          </div>
        </ion-card-content>
      </ion-card>

    </div>

    <div *ngIf="selectedTab=='comments'">

      <ion-toolbar>
        <ion-buttons slot="end">
          <ion-button size="small" (click)="addComment()" title="Add a comment or charging check-in">
            <ion-icon name="chatbubbles" slot="start"></ion-icon>
            <ion-label>Add Comment</ion-label>
          </ion-button>

        </ion-buttons>

      </ion-toolbar>

      <ng-container *ngIf="poi._hasComments==true">
        <ion-card *ngFor="let item of poi.UserComments">
          <ion-item>
            <ion-avatar slot="start">
              <img *ngIf="item.User && item.User.ProfileImageURL" src="{{item.User?.ProfileImageURL}}" />
            </ion-avatar>
            <ion-label>
              <span *ngIf="item.User">{{item.User.Username}}</span>
              <span *ngIf="!item.User">{{item.Username}}</span>
            </ion-label>
            <ion-label slot="end">
              {{item.DateCreated | date }}
            </ion-label>
          </ion-item>


          <ion-card-content>

            <p>{{item.Comment}}</p>
            <p *ngIf="item.CommentTypeID!=10">
              {{item.CommentType?.Title}}

            </p>
            <p *ngIf="item.Rating">Rating: {{item.Rating}} out of 5</p>
            <p *ngIf="item.CheckinStatusType">

              {{item.CheckinStatusType.Title}}</p>

          </ion-card-content>
        </ion-card>
      </ng-container>

      <p *ngIf="poi._hasComments==false">
        {{ 'ocm.details.commentsAndRatings.zeroComments' | translate }}
      </p>

    </div>
    <div *ngIf="selectedTab=='media'">

      <ion-toolbar>
        <ion-buttons slot="end">

          <ion-button size="small" (click)="addMedia()" title="Add a Photo">
            <ion-icon name="camera" slot="start"></ion-icon>
            <ion-label> Add Photo</ion-label>
          </ion-button>


        </ion-buttons>

      </ion-toolbar>


      <div *ngIf="poi._hasPhotos">

        <ion-card *ngFor="let item of poi.MediaItems">

          <ion-item>
            <ion-avatar slot="start">
              <img *ngIf="item.User && item.User.ProfileImageURL" src="{{item.User?.ProfileImageURL}}" />
            </ion-avatar>
            <ion-label>
              <span *ngIf="item.User">{{item.User.Username}}</span>
              <span *ngIf="!item.User">{{item.Username}}</span>
            </ion-label>
            <ion-label slot="end">
              {{item.DateCreated | date }}
            </ion-label>
          </ion-item>


          <img src="{{item.ItemMediumURL}}" />

          <ion-card-content>
            <p>{{item.Comment}}</p>
          </ion-card-content>

        </ion-card>
      </div>

      <div *ngIf="!poi._hasPhotos">
        <p class='subtle'> {{ 'ocm.details.mediaItems.addPrompt' | translate }}</p>
      </div>
    </div>
    <p *ngIf="appManager.isDebugMode==true" style="white-space: pre-wrap;"> {{json}}</p>

  </div>
  <div *ngIf="poi==null || poi.AddressInfo==null">
    <h2>POI Not Found</h2>
    <p>The POI details could not be loaded.</p>
  </div>